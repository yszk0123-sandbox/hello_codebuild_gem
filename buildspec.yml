version: 0.2

env:
  variables:
    FOO: bar

phases:
  install:
    commands:
      - echo "---------- install yarn"
      - apt-get update
      - apt-get install -y apt-transport-https
      - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
      - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list
      - apt-get update
      - apt-get install -y yarn
      - echo "---------- install packages"
      - which node
      - which yarn
      - node --version
      - yarn --version
      - cd frontend && yarn && cd ..
  build:
    commands:
      - echo "---------- build begin"
      - pwd
      - echo "Hello, $FOO"
      - cd frontend && yarn build && cd ..
      - pwd
      - echo "---------- build end"
  post_build:
    commands:
      - echo "---------- post_build"
      - pwd

artifacts:
  files:
    - README.rdoc
    - Gemfile
    - frontend/dist/*
  discard-paths: yes
